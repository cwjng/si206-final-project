import sqlite3
import matplotlib.pyplot as plt
import matplotlib.ticker as ticker

# Connect to the database
conn = sqlite3.connect('top_artists.db')
c = conn.cursor()

# Select the top 25 artists with the highest number of Twitter engagements
c.execute("SELECT id, name, streams, tweets, retweets, mentions, total_engagements FROM top_artists ORDER BY total_engagements DESC LIMIT 25")
data = c.fetchall()

# Extract the data for the scatter plot
names = [row[1] for row in data]
streams = [row[2] for row in data]
engagements = [row[6] for row in data]

# Create a scatter plot of the data with smaller markers
plt.scatter(engagements, streams)

# Set the x and y-axis labels and title
plt.xlabel('Twitter Engagements')
plt.ylabel('Spotify Streams')
plt.title('Correlation Between Twitter Engagements and Spotify Streams')

# Add text labels for each point
for i, name in enumerate(names):
    plt.annotate(name, (engagements[i], streams[i]), fontsize=8)


# Show the plot
plt.show()

# Close the database connection
conn.close()
